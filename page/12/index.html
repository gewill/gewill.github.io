<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
<meta property="og:type" content="website">
<meta property="og:title" content="Will&#39;s Blog">
<meta property="og:url" content="http://example.com/page/12/index.html">
<meta property="og:site_name" content="Will&#39;s Blog">
<meta property="og:description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Ge Will">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/12/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/12/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Will's Blog</title>
  







<head>
    <!-- 霞鹜文楷字体 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/style.css"/>

    <!-- datapulse统计 -->
    <script defer type="text/javascript" src="https://datapulse.app/datapulse.min.js" id="datapulse" data-endpoint="https://datapulse.app/api/v1/event" data-workspace="cljxqml5q0y0f8j37d4futnbl"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DR0FC9YJLH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-DR0FC9YJLH');
    </script>
</head>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Will's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">198</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">17</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">1</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Ge Will"
      src="/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">Ge Will</p>
  <div class="site-description" itemprop="description">The people who are crazy enough to think they can change the world, are the ones who DO.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">198</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/gewill" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;gewill" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:531sunlight@gmail.com" title="E-Mail → mailto:531sunlight@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/gewei" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;gewei" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/BoJack_D" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;BoJack_D" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/05/prepareForSegue-sender/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/09/05/prepareForSegue-sender/" class="post-title-link" itemprop="url">Difference Segue Excute in Container View to AVPlayerViewController</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-09-05 08:34:38" itemprop="dateCreated datePublished" datetime="2015-09-05T08:34:38+08:00">2015-09-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-01-13 11:01:04" itemprop="dateModified" datetime="2025-01-13T11:01:04+08:00">2025-01-13</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="1-Difference-Segue-Excute-in-Container-View-to-AVPlayerViewController"><a href="#1-Difference-Segue-Excute-in-Container-View-to-AVPlayerViewController" class="headerlink" title="1. Difference Segue Excute in Container View to AVPlayerViewController"></a>1. Difference Segue Excute in Container View to AVPlayerViewController</h2><blockquote>
<p>Demo on <a target="_blank" rel="noopener" href="https://github.com/gewill/test-projects/tree/master/test%20prepare%20for%20segue%20between%20Swift%20and%20Objective-C">GitHub</a></p>
</blockquote>
<h3 id="Objective-C-this-method-won’t-be-execute"><a href="#Objective-C-this-method-won’t-be-execute" class="headerlink" title="Objective-C this method won’t be execute."></a>Objective-C this method won’t be execute.</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// In Swift should check the method, even user don&#x27;t tap the cantainer view.</span></span><br><span class="line"><span class="comment">// But in Objective-C,  *** Terminating app due to uncaught exception &#x27;NSInvalidUnarchiveOperationException&#x27;, </span></span><br><span class="line"><span class="comment">// reason: &#x27;Could not instantiate class named AVPlayerViewController&#x27;</span></span><br><span class="line">- (<span class="type">void</span>)prepareForSegue:(<span class="built_in">UIStoryboardSegue</span> *)segue sender:(<span class="type">id</span>)sender &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// set up the player</span></span><br><span class="line">    <span class="keyword">if</span> ([segue.identifier  isEqual: <span class="string">@&quot;videoSegue&quot;</span>]) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSString</span> *path = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@&quot;yishengsuoai&quot;</span> ofType:<span class="string">@&quot;mp4&quot;</span>];</span><br><span class="line">        <span class="built_in">NSURL</span> *url = [[<span class="built_in">NSURL</span> alloc] initFileURLWithPath:path];</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">AVPlayerViewController</span> *vc = segue.destinationViewController;</span><br><span class="line">        vc.player = [<span class="built_in">AVPlayer</span> playerWithURL:url];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BEGIN avkit_ios_config</span></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">prepareForSegue</span>(<span class="params">segue</span>: <span class="type">UIStoryboardSegue</span>, <span class="params">sender</span>: <span class="type">AnyObject</span>?)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> segue.identifier <span class="operator">==</span> <span class="string">&quot;videoSegue&quot;</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// set up the player</span></span><br><span class="line">        <span class="keyword">let</span> videoURL <span class="operator">=</span> <span class="type">NSBundle</span>.mainBundle().<span class="type">URLForResource</span>(<span class="string">&quot;TestVideo&quot;</span>,</span><br><span class="line">                                                       withExtension: <span class="string">&quot;m4v&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> videoViewController <span class="operator">=</span></span><br><span class="line">                   segue.destinationViewController <span class="keyword">as!</span> <span class="type">AVPlayerViewController</span></span><br><span class="line">        videoViewController.player <span class="operator">=</span> <span class="type">AVPlayer</span>(URL: videoURL)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// END avkit_ios_config</span></span><br></pre></td></tr></table></figure>

<h2 id="2-Conclusion"><a href="#2-Conclusion" class="headerlink" title="2. Conclusion"></a>2. Conclusion</h2><ul>
<li>Swift + Container View（In IB）</li>
<li>Objective-C + AVPlayerLayer (In Code)</li>
</ul>
<h2 id="3-Definiton"><a href="#3-Definiton" class="headerlink" title="3. Definiton"></a>3. Definiton</h2><h3 id="prepareForSegue-sender"><a href="#prepareForSegue-sender" class="headerlink" title="- prepareForSegue:sender:"></a>- prepareForSegue:sender:</h3><p>Notifies the view controller that a segue is about to be performed.</p>
<p>###Discussion</p>
<p>The default implementation of this method does nothing. Your view controller overrides this method when it needs to pass relevant data to the new view controller. The segue object describes the transition and includes references to both view controllers involved in the segue.</p>
<p>Because segues can be triggered from multiple sources, you can use the information in the segue and sender parameters to disambiguate between different logical paths in your app. For example, if the segue originated from a table view, the sender parameter would identify the table view cell that the user tapped. You could use that information to set the data on the destination view controller.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/04/Delete-the-extra-separator-of-UITableView-with-pain-style/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/09/04/Delete-the-extra-separator-of-UITableView-with-pain-style/" class="post-title-link" itemprop="url">Delete the extra separator of UITableView with pain style</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-09-04 18:24:36" itemprop="dateCreated datePublished" datetime="2015-09-04T18:24:36+08:00">2015-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-01-13 11:01:04" itemprop="dateModified" datetime="2025-01-13T11:01:04+08:00">2025-01-13</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="“Delete”-the-extra-separator-of-UITableView-with-pain-style"><a href="#“Delete”-the-extra-separator-of-UITableView-with-pain-style" class="headerlink" title="“Delete” the extra separator of UITableView with pain style"></a>“Delete” the extra separator of UITableView with pain style</h2><p><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/1369831/eliminate-extra-separators-below-uitableview-in-iphone-sdk">ios - Eliminate Extra separators below UITableView - in iphone sdk? - Stack Overflow</a></p>
<h3 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution 1"></a>Solution 1</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &quot;Delete&quot; the extra separator of UITableView and the last one Separator in ecah Section</span></span><br><span class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForFooterInSection:(<span class="built_in">NSInteger</span>)section &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.01</span>f;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://i.imgur.com/PYNMsFb.png" alt="height=0.01f"></p>
<h3 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution 2"></a>Solution 2</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)viewDidLoad &#123;</span><br><span class="line">	<span class="keyword">self</span>.tableView.tableFooterView = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="built_in">CGRectZero</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://i.imgur.com/h4A0jWN.png" alt="CGRectZero"></p>
<h2 id="Table-View-Style"><a href="#Table-View-Style" class="headerlink" title="Table View Style"></a>Table View Style</h2><p><strong>UITableViewStylePlain</strong></p>
<p>A plain table view. Any section headers or footers are displayed as inline separators and float when the table view is scrolled.</p>
<p><strong>UITableViewStyleGrouped</strong></p>
<p>A table view whose sections present distinct groups of rows. The section headers and footers do not float.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/01/GeekBand-Test-3-Classmates/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/09/01/GeekBand-Test-3-Classmates/" class="post-title-link" itemprop="url">GeekBand Test 3: Classmates</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-09-01 07:51:54" itemprop="dateCreated datePublished" datetime="2015-09-01T07:51:54+08:00">2015-09-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-01-13 11:01:04" itemprop="dateModified" datetime="2025-01-13T11:01:04+08:00">2025-01-13</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>极客班iOS应用开发实战测试题二（8月31日）</p>
<p>习题：同学录</p>
<blockquote>
<p>项目源码见 <a target="_blank" rel="noopener" href="https://github.com/gewill/GeekBand-IOS-1501-Homework/tree/new-branch/G2015010176/%E6%9E%81%E5%AE%A2%E7%8F%ADiOS%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98%E6%B5%8B%E8%AF%95%E9%A2%98%E4%BA%8C%EF%BC%888%E6%9C%8831%E6%97%A5%EF%BC%89">GitHub</a>。</p>
<p>v1.5以后使用 CocoaPods，<code>.gitignore</code>包含<code>/pod</code>，下载后请 <code>pod install</code>。</p>
</blockquote>
<h2 id="1-题目要求："><a href="#1-题目要求：" class="headerlink" title="1. 题目要求："></a>1. 题目要求：</h2><ul>
<li>实现一个同学录列表，包含姓名、简介和头像等信息。</li>
<li>可以添加新的同学，支持拍照添加头像。</li>
<li>可以查看每一个的同学详情页。</li>
<li>实现存储所有同学的信息。</li>
</ul>
<p><img src="http://i.imgur.com/kdKYL12.png" alt="Classmates"></p>
<h2 id="2-实际开发遇到的点："><a href="#2-实际开发遇到的点：" class="headerlink" title="2. 实际开发遇到的点："></a>2. 实际开发遇到的点：</h2><ul>
<li>Add Parse</li>
<li>Add iCloud</li>
<li>input view : <a target="_blank" rel="noopener" href="https://github.com/slackhq/SlackTextViewController">https://github.com/slackhq/SlackTextViewController</a></li>
<li>统一的属性命名，vc，db，object</li>
<li>各种输入框的逻辑处理和键盘跳出前后 UI 自动调整：<a target="_blank" rel="noopener" href="http://code.tutsplus.com/tutorials/ios-sdk-keeping-content-from-underneath-the-keyboard--mobile-6103">http://code.tutsplus.com/tutorials/ios-sdk-keeping-content-from-underneath-the-keyboard--mobile-6103</a></li>
<li>添加删除，编辑功能</li>
<li>Search</li>
<li>Sort</li>
<li>清晰的项目目录结构</li>
<li>Dash 集成了 Cocoa Docsets： 如 Realm、FFDB &amp; AFNetworking etc.</li>
<li>Dash Bookmark 有点用，可惜不能同步到 iOS</li>
<li>Use Realm</li>
<li>学习新的框架或知识点：一看 API，二看 Examples</li>
<li>Realm query 还需熟悉提高</li>
<li>Debug 尤其需要提高，思路要清晰，断点可以下多几个，查值要玩转。</li>
<li>The Realm Browser is <a target="_blank" rel="noopener" href="https://itunes.apple.com/app/realm-browser/id1007457278">available on the Mac App Store</a>.</li>
<li><a target="_blank" rel="noopener" href="http://www.runoob.com/sqlite/sqlite-data-types.html">SQLite 数据类型</a></li>
<li>Updating Objects</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Updating Objects with primary keys</span></span><br><span class="line"><span class="comment">// This will make properties no settled be NULL</span></span><br><span class="line">[GWClassmate createOrUpdateInDefaultRealmWithValue:newClassmate];</span><br></pre></td></tr></table></figure>
<ul>
<li><p>两种编辑保存界面: 微信进入编辑的界面，Back 有个Alert确认保存; Phone.app 则是禁用右滑和 Back，显示 Cancel &amp; Done，也是完善的方案。<br><img src="http://ww2.sinaimg.cn/large/5369602ejw1evo9v2ahltj20ts15p43r.jpg" alt="Edit View"></p>
</li>
<li><p>Estimating default values for properties of Classmate</p>
<ul>
<li>In <code>Domain Logic</code>: ClassmateDB.h&#x2F;m (BEST Solution)</li>
<li>In <code>Model</code>: Classmate.h&#x2F;m, Specify default values. BUT Realm isn’t support nil property.</li>
<li>In <code>View Controller</code>: if&#x2F;esle</li>
<li>In <code>Interface Builder</code>: Setting a default value. Especially giving a default avatar is a nice solution for user.</li>
</ul>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://cocoadocs.org/docsets/Realm/0.95.0/Constants/RLMPropertyType.html">RLMPropertyType Constants Reference</a>
  </p>
</blockquote>
</li>
<li><p>“To use AVAsset to extract metadata informations, this post is useful.” <a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/16318821/extracting-mp3-album-artwork-in-ios">http://stackoverflow.com/questions/16318821/extracting-mp3-album-artwork-in-ios</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://jacopretorius.net/2013/02/playing-video-in-ios.html">Playing video in iOS</a></p>
</li>
<li><p>Use Clang-Format -&gt; LLVM (default)</p>
</li>
</ul>
<h2 id="3-项目完成情况："><a href="#3-项目完成情况：" class="headerlink" title="3. 项目完成情况："></a>3. 项目完成情况：</h2><p>完成1.0: </p>
<ul>
<li>基本功能完成</li>
<li>列表使用了缩略图，待优化直接保存数据库</li>
<li>输入键盘时，View 自动升降一个键盘高度，以保持可见</li>
<li>保存是检验用户名，不能为空</li>
<li>使用 Realm 数据库</li>
<li>classmate.h&#x2F;m 为 Model，四个属性分别为：uuid、name、info &amp; avator</li>
<li>Using GWDetailViewController as super class to GWShowDetailViewController can easy to create a new view.</li>
</ul>
<blockquote>
<p>2015-08-31 20:17:00</p>
</blockquote>
<p>完成1.1:</p>
<ul>
<li>使用 FMDB</li>
</ul>
<blockquote>
<p>把习题同学录的存储 Realm 换成 FMDB，午饭到16：00还没吃，我的学习新的知识的能力还比较低的。需要投入更多时间来学习了。</p>
</blockquote>
<blockquote>
<p>2015-09-01 16:09:00</p>
</blockquote>
<p>完成1.2:</p>
<ul>
<li>换回 Realm</li>
<li>增加编辑和删除功能</li>
</ul>
<blockquote>
<p>2015-09-01 20:00:00</p>
</blockquote>
<p>完成1.3:</p>
<ul>
<li>随机添加修改和删除10000个classmate，以测试性能</li>
<li>Add a tab bar view as root view </li>
<li>UI layout like Wechat </li>
<li>Set UUID as parimary key </li>
<li>Updating Objects With Primary Keys</li>
<li>把取消按钮改为 Button，并把 Segue to GWDetailViewController &amp; GWShowDetailViewController， 改为 Modle</li>
<li>New a manaager class: GWClassmateDB, to abstract most useful SUQD methods and testing methods.</li>
</ul>
<blockquote>
<p>2015-09-02 18:20:47</p>
</blockquote>
<p>完成1.4:</p>
<ul>
<li>Change cell’s Accessory form Detail to Disclosure Indicator</li>
<li>Specify default values for properties of Classmate.h&#x2F;m</li>
<li>Add Music Tab</li>
<li>Add a “red dot badge” on avatars’ view for test. </li>
<li>Change the classmates display style. Just looks like WeChat.app.</li>
</ul>
<blockquote>
<p>2015-09-06 11:43:19</p>
</blockquote>
<p><img src="http://i.imgur.com/2lEu3Og.jpg" alt="Classmates v1.4"></p>
<p>进行中1.5:</p>
<ul>
<li>Adapting to MVVM</li>
<li><a target="_blank" rel="noopener" href="http://objccn.io/issue-15-2/">XCTest</a></li>
<li>Add a ‘Edit’ Button, and after taped the ‘back’ button in navigation change to “cancel”, add a “Done” in right. Just looks like Phone.app.</li>
<li>Add Sort by name, and index by initial</li>
<li>Add Search</li>
</ul>
<h2 id="4-BUG"><a href="#4-BUG" class="headerlink" title="4. BUG"></a>4. BUG</h2><p>以下的代码提示越界错误：Terminating app due to uncaught exception ‘RLMException’, reason: ‘Index is out of bounds.’可能的原因：</p>
<blockquote>
<p>需要注意的是，写入操作会相互阻塞，而且其相对应的进程也会受到影响。这和其他的永久数据存储解决方案是一样的，所以我们建议你使用常用的，也是最有效的方案， 将所有写入放到一个单独的进程中。<a target="_blank" rel="noopener" href="https://realm.io/cn/docs/objc/latest/">https://realm.io/cn/docs/objc/latest/</a></p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)prepareForSegue:(<span class="built_in">UIStoryboardSegue</span> *)segue sender:(<span class="type">id</span>)sender</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ([segue.identifier isEqualToString:<span class="string">@&quot;showDetail&quot;</span>]) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSIndexPath</span> *indexPath = [<span class="keyword">self</span>.tableView indexPathForCell:sender];</span><br><span class="line">        GWCustomTableViewCell *cell = (GWCustomTableViewCell *)[<span class="keyword">self</span>.tableView cellForRowAtIndexPath:indexPath];</span><br><span class="line">        </span><br><span class="line">        GWDetailViewController *vc = (GWDetailViewController *)segue.destinationViewController;</span><br><span class="line">        </span><br><span class="line"><span class="comment">//        vc.userid       = cell.userid;</span></span><br><span class="line">        vc.name.text    = cell.name.text;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最终解决方法是修改 Custom Cell 中添加一个 UILabel 的 text 来存储 UUID，并设置为隐藏。并添加使用 Detail Disclosure 测试 NSLog UUID。具体的越界问题，还需要在研究。</p>
<h2 id="5-Further-Reading"><a href="#5-Further-Reading" class="headerlink" title="5. Further Reading"></a>5. Further Reading</h2><ul>
<li><a target="_blank" rel="noopener" href="http://nshipster.com/random/">rand(3) &#x2F; random(3) &#x2F; arc4random(3) &#x2F; et al.</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.ibireme.com/2015/05/18/runloop/#apple">深入理解 RunLoop</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/01/iOS-Map/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/09/01/iOS-Map/" class="post-title-link" itemprop="url">iOS Map</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-09-01 07:48:19" itemprop="dateCreated datePublished" datetime="2015-09-01T07:48:19+08:00">2015-09-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-01-13 11:01:04" itemprop="dateModified" datetime="2025-01-13T11:01:04+08:00">2025-01-13</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>按照<a target="_blank" rel="noopener" href="http://weibo.com/pinxue">@杨武</a>老师的学习和复习方法，我整理的 iOS Map。</p>
<p>回家从头开始做了这个 Map，确实对梳理知识点和复习记忆有很多的帮助。其中 Blocks、Network &amp; Persistence 都还有待学习加强的点。以后学习新的还需要更新。</p>
<p><img src="http://ww4.sinaimg.cn/large/5369602egw1eyccfaqwhzj21bu0qadll.jpg" alt="iOS Map"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/08/29/GeekBand-flip-classroom-week-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/08/29/GeekBand-flip-classroom-week-7/" class="post-title-link" itemprop="url">极客班线下翻转课堂第七周</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-08-29 09:38:34" itemprop="dateCreated datePublished" datetime="2015-08-29T09:38:34+08:00">2015-08-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-01-13 11:01:04" itemprop="dateModified" datetime="2025-01-13T11:01:04+08:00">2025-01-13</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="杨武老师全天辅导"><a href="#杨武老师全天辅导" class="headerlink" title="@杨武老师全天辅导"></a><a target="_blank" rel="noopener" href="http://weibo.com/pinxue">@杨武</a>老师全天辅导</h2><h3 id="1-学习，不仅要学，还要习："><a href="#1-学习，不仅要学，还要习：" class="headerlink" title="1. 学习，不仅要学，还要习："></a>1. 学习，不仅要学，还要习：</h3><ul>
<li><p>作业，不仅仅是作业。有信心拿给未来的面试官看不？</p>
</li>
<li><p>作业是一个机会，做完基本功能后，琢磨着如何完善优化。要求自己的代码容易别人看懂。看我做的多牛逼，风格好。</p>
</li>
<li><p>学习要复习，主动回忆+分散重复。尤其凭空去做。</p>
<p>  被动学习有个线索如书和 Demo，才有思路。只有做练习时，才能主动回忆知识。回忆方法：<strong>Mind Map</strong></p>
</li>
</ul>
<h3 id="2-课堂上共同整理了一份-iOS-Map，涉及到的一些知识点："><a href="#2-课堂上共同整理了一份-iOS-Map，涉及到的一些知识点：" class="headerlink" title="2. 课堂上共同整理了一份 iOS Map，涉及到的一些知识点："></a>2. 课堂上共同整理了一份 iOS Map，涉及到的一些知识点：</h3><ul>
<li>NARC (new alloc retain copy)</li>
<li>ARC 不是垃圾收集，只是一个语法糖</li>
<li>Xcode Preprocess, Assembly and Disassembly</li>
<li>LLDB: help</li>
<li><a target="_blank" rel="noopener" href="http://objccn.io/issue-19/">调试</a></li>
<li>IB: Outlets 直接访问 UI</li>
<li>设计师设计一个功能的难度和程序员实现的难度</li>
<li>常用 UI 文档介绍，追根究底</li>
<li><a target="_blank" rel="noopener" href="http://objccn.io/issue-15/">单元测试等</a></li>
</ul>
<h3 id="3-习题很重要："><a href="#3-习题很重要：" class="headerlink" title="3. 习题很重要："></a>3. 习题很重要：</h3><ul>
<li>想学好，每天都要投入2个小时到开发中</li>
<li>刷题提高技术</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/08/28/GeekBand-iOS-APP-Development-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/08/28/GeekBand-iOS-APP-Development-6/" class="post-title-link" itemprop="url">极客班 iOS 应用开发实战（六）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-08-28 23:07:28" itemprop="dateCreated datePublished" datetime="2015-08-28T23:07:28+08:00">2015-08-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-01-13 11:01:04" itemprop="dateModified" datetime="2025-01-13T11:01:04+08:00">2025-01-13</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>段老师的视频教程，采用都是比较通用是 Demo，方便以后代码复用。也是从项目实践经验来教授相关知识如 FMDB，这几节课获益匪浅。</p>
<blockquote>
<p>Demo 源码见 <a target="_blank" rel="noopener" href="https://github.com/gewill/GeekBand-iOS-Demo/tree/master/iOS%20APP%20Development">Github</a>，并添加了相关注释。</p>
</blockquote>
<h2 id="28-沙盒机制"><a href="#28-沙盒机制" class="headerlink" title="28. 沙盒机制"></a>28. 沙盒机制</h2><p>介绍几种数据持久化的方案，选择合适项目的方案：</p>
<ul>
<li>沙盒机制</li>
<li>NSFileManager</li>
<li>Plist、Archive数据归档 *  SQLite3应用</li>
<li>NSUserDefaults</li>
</ul>
<p>沙盒目录结构 <code>NSDocumentDirectory</code>：</p>
<ul>
<li>Application Bundle&#x2F;</li>
<li>Documents&#x2F;</li>
<li>Library&#x2F;Caches&#x2F;</li>
<li>Library&#x2F;Perferences&#x2F;</li>
<li>tmp&#x2F;</li>
</ul>
<h2 id="29-NSFileManager-amp-Plist"><a href="#29-NSFileManager-amp-Plist" class="headerlink" title="29. NSFileManager &amp; Plist"></a>29. NSFileManager &amp; Plist</h2><p><strong>存取文档的方法</strong>封装一个通用的类<code>BLUtility.h/m</code>，方便调用。以下代码是测试保存文本文档。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  BLUtility.m</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  创建目录</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param dirPath 待创建的目录</span></span><br><span class="line"><span class="comment"> *  @param isDir   结尾是否是目录</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 是否创建成功</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="built_in">NSString</span>*) getPathWithinDocumentDir:(<span class="built_in">NSString</span>*)aPath &#123;</span><br><span class="line">	<span class="built_in">NSString</span> *fullPath = <span class="literal">nil</span>;</span><br><span class="line">	<span class="built_in">NSArray</span> *paths = <span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> ([paths count] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		fullPath = (<span class="built_in">NSString</span> *)[paths objectAtIndex:<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">if</span> ([aPath length] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			fullPath = [fullPath stringByAppendingPathComponent:aPath];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> fullPath;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  BLArchiveViewController.m</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  测试保存文档和 plist 的按钮关联的 Action 方法</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param sender &lt;#sender description#&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="type">void</span>)writeFileButtonClicked:(<span class="type">id</span>)sender &#123;</span><br><span class="line">    <span class="comment">// 1 - 测试字符串文档，保存到 Documents</span></span><br><span class="line">    <span class="comment">// 1.1 - 生成并保存</span></span><br><span class="line">    <span class="built_in">NSString</span> *string = <span class="string">@&quot;ABC副经理&quot;</span>;</span><br><span class="line">    <span class="built_in">NSString</span> *stringFilePath = [BLUtility getPathWithinDocumentDir:<span class="string">@&quot;string.text&quot;</span>];</span><br><span class="line">    [BLUtility createDirectory:stringFilePath lastComponentIsDirectory:<span class="literal">NO</span>];</span><br><span class="line">    [string writeToFile:stringFilePath atomically:<span class="literal">YES</span> encoding:<span class="built_in">NSUTF8StringEncoding</span> error:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="30-Archive-数据归档和-NSUserDefaults"><a href="#30-Archive-数据归档和-NSUserDefaults" class="headerlink" title="30. Archive 数据归档和 NSUserDefaults"></a>30. Archive 数据归档和 NSUserDefaults</h3><p><strong>转化为 NSData，二进制的数据，利于存储和传输。</strong></p>
<p>遵循 NSCoding 协议，即可实现编码和解码的类，进一步对其归档和解档。也用到了封装的类<code>BLUtility.h/m</code>。本例中文档保存到 NSUserDefaults：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  BLUser.m</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  解码</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param aDecoder 编码类型</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 解码得到的对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="type">id</span>)initWithCoder:(<span class="built_in">NSCoder</span> *)aDecoder &#123;</span><br><span class="line">	<span class="keyword">self</span> = [<span class="variable language_">super</span> init];</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">		<span class="keyword">self</span>.userName	= [aDecoder decodeObjectForKey:<span class="string">@&quot;userName&quot;</span>];</span><br><span class="line">		<span class="keyword">self</span>.email		= [aDecoder decodeObjectForKey:<span class="string">@&quot;email&quot;</span>];</span><br><span class="line">		<span class="keyword">self</span>.password	= [aDecoder decodeObjectForKey:<span class="string">@&quot;password&quot;</span>];</span><br><span class="line">		<span class="keyword">self</span>.age		= [aDecoder decodeIntForKey:<span class="string">@&quot;age&quot;</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  BLUtility.m</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  解档</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param archivedData 待解档的 NSData</span></span><br><span class="line"><span class="comment"> *  @param key           key</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return  解档完成的对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="built_in">NSObject</span> *) unarchiverObject:(<span class="built_in">NSData</span> *)archivedData withKey:(<span class="built_in">NSString</span> *)key &#123;</span><br><span class="line">	<span class="keyword">if</span>(archivedData == <span class="literal">nil</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">NSKeyedUnarchiver</span> *unarchiver = [[<span class="built_in">NSKeyedUnarchiver</span> alloc] initForReadingWithData:archivedData];</span><br><span class="line">	<span class="built_in">NSObject</span> *object = [unarchiver decodeObjectForKey:key];</span><br><span class="line">	[unarchiver finishDecoding];</span><br><span class="line">	<span class="keyword">return</span> object;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  BLArchiveViewController.m</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  读取按钮关联的 Action 方法</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param sender &lt;#sender description#&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="type">void</span>) readButtonClicked:(<span class="type">id</span>)sender &#123;</span><br><span class="line">    <span class="built_in">NSUserDefaults</span> *userDefaults = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</span><br><span class="line">    <span class="built_in">NSInteger</span> test = [userDefaults integerForKey:<span class="string">@&quot;integer&quot;</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;test = %li&quot;</span>, test);</span><br><span class="line">    </span><br><span class="line">	<span class="built_in">NSString</span> *userDataPath = [BLUtility getPathWithinDocumentDir:UserDataName];</span><br><span class="line">	<span class="keyword">if</span> ([userDataPath length] &gt; <span class="number">0</span> &amp;&amp; [[<span class="built_in">NSFileManager</span> defaultManager] fileExistsAtPath:userDataPath]) &#123;</span><br><span class="line">        <span class="built_in">NSData</span> *userData = [<span class="built_in">NSData</span> dataWithContentsOfFile:userDataPath];</span><br><span class="line">		BLUser *user = (BLUser *)[BLUtility unarchiverObject:userData withKey:<span class="string">@&quot;UserData&quot;</span>];</span><br><span class="line">		_userNameTextField.text = user.userName;</span><br><span class="line">		_emailTextField.text = user.email;</span><br><span class="line">		_passwordTextField.text = user.password;</span><br><span class="line">		_ageTextField.text = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@&quot;%ld&quot;</span>, user.age];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>###延伸阅读：</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://nshipster.cn/nscoding/">NSCoding &#x2F; NSKeyed​Archiver</a></li>
<li><a target="_blank" rel="noopener" href="http://nshipster.cn/nsfilemanager/">NSFile​Manager</a></li>
</ul>
<h2 id="31-SQLite3"><a href="#31-SQLite3" class="headerlink" title="31. SQLite3"></a>31. SQLite3</h2><p>通过 FMDB 封装，得以 OBjective-C 访问 SQLite，完成常用增删改查。从语法和数据体积实现轻量级存储方案。这个方案稍后用在习题“同学录”上实践一下。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  BLPoemDB.h</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="string">&quot;FMDatabase.h&quot;</span></span></span><br><span class="line"><span class="meta">#import <span class="string">&quot;BLPoem.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BLPoemDB</span> : <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  创建一个 FMDatabase 实例</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	FMDatabase		*_db;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  创建一个表</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 是否创建成功</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="type">BOOL</span>) createPoemTable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  增加一首诗到表</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param poem 待添加的诗</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 是否添加成功</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="type">BOOL</span>) addPoem:(BLPoem *)poem;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  查询所有诗</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 查询到的包含所有诗的数组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">NSMutableArray</span> *) getAllPoems;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  查询被收藏的诗</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 查询到的包含所有收藏的诗的数组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">NSMutableArray</span> *) getFavoritesPoems;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  更改是非收藏这一首诗</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param favorite 是否收藏</span></span><br><span class="line"><span class="comment"> *  @param poemId   待更改的诗的 ID</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 是否更改收藏成功</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="type">BOOL</span>) setFavorite:(<span class="type">BOOL</span>)favorite favoriteId:(<span class="built_in">NSInteger</span>)poemId;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  删除指定 ID 的一首诗</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param poemId 待删除的诗的 ID</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return  是否删除成功</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="type">BOOL</span>) deletePoemWithPoemId:(<span class="built_in">NSInteger</span>)poemId;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  BLPoemDB.m</span></span><br><span class="line"><span class="comment">//  BLDataSaveDemo</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="string">&quot;BLPoemDB.h&quot;</span></span></span><br><span class="line"><span class="meta">#import <span class="string">&quot;BLUtility.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BLPOEMDBNAME @<span class="string">&quot;BLPoemDB.sqlite&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">BLPoemDB</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  初始化数据库 FMDatabase 实例</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 初始化得到的 FMDatabase 实例</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="type">id</span>) init &#123;</span><br><span class="line">	<span class="keyword">self</span> = [<span class="variable language_">super</span> init];</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">		<span class="built_in">NSString</span> *dbPath = [BLUtility getPathWithinDocumentDir:BLPOEMDBNAME];</span><br><span class="line">		<span class="built_in">NSFileManager</span> *fileManager = [<span class="built_in">NSFileManager</span> defaultManager];</span><br><span class="line">		<span class="type">BOOL</span> existFile = [fileManager fileExistsAtPath:dbPath];</span><br><span class="line">		<span class="keyword">if</span> (existFile == <span class="literal">NO</span>) &#123;</span><br><span class="line">			<span class="built_in">NSString</span> *poemDBPath = [[[<span class="built_in">NSBundle</span> mainBundle] resourcePath] stringByAppendingPathComponent:BLPOEMDBNAME];</span><br><span class="line">			[fileManager copyItemAtPath:poemDBPath toPath:dbPath error:<span class="literal">nil</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		_db	 = [[FMDatabase alloc] initWithPath:dbPath];</span><br><span class="line">		<span class="keyword">if</span> ([_db open] == <span class="literal">NO</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="type">BOOL</span>) createPoemTable &#123;</span><br><span class="line">	[_db beginTransaction];</span><br><span class="line">	<span class="type">BOOL</span> success = [_db executeUpdate:<span class="string">@&quot;CREATE TABLE IF NOT EXISTS POEMTABLE (&quot;</span></span><br><span class="line">					<span class="string">@&quot;ID INTEGER PRIMARY KEY NOT NULL,&quot;</span></span><br><span class="line">					<span class="string">@&quot;POEMNAME TEXT NOT NULL,&quot;</span></span><br><span class="line">					<span class="string">@&quot;POETNAME TEXT NOT NULL,&quot;</span></span><br><span class="line">					<span class="string">@&quot;POEMCONTENT TEXT NOT NULL,&quot;</span></span><br><span class="line">					<span class="string">@&quot;WHETHERFAVORITE BOOL NOT NULL);&quot;</span>];</span><br><span class="line">	[_db commit];</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(!success || [_db hadError]) &#123;</span><br><span class="line">		[_db rollback];</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="type">BOOL</span>) addPoem:(BLPoem *)poem &#123;</span><br><span class="line">	FMResultSet *rs = [_db executeQuery:<span class="string">@&quot;SELECT ID FROM POEMTABLE WHERE ID=?&quot;</span>, [<span class="built_in">NSNumber</span> numberWithInteger:poem.poemId]];</span><br><span class="line">	<span class="keyword">if</span>(rs &amp;&amp; [rs next]) &#123;</span><br><span class="line">		[rs close];</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	[rs close];</span><br><span class="line">	</span><br><span class="line">	[_db beginTransaction];</span><br><span class="line">	<span class="built_in">NSString</span> *bookMark = <span class="literal">nil</span>;		</span><br><span class="line">	<span class="type">BOOL</span> success =  [_db executeUpdate:<span class="string">@&quot;INSERT OR IGNORE INTO POEMTABLE (ID,POEMNAME,POETNAME,POEMCONTENT,WHETHERFAVORITE) VALUES (?,?,?,?,?);&quot;</span>,</span><br><span class="line">					 [<span class="built_in">NSNumber</span> numberWithInteger:poem.poemId],</span><br><span class="line">					 poem.poemName,</span><br><span class="line">					 poem.poetName,</span><br><span class="line">					 poem.poemContent,</span><br><span class="line">					 [<span class="built_in">NSNumber</span> numberWithBool:poem.whetherFavorite],</span><br><span class="line">					 bookMark];</span><br><span class="line">	[_db commit];</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(!success || [_db hadError]) &#123;</span><br><span class="line">		[_db rollback];</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSMutableArray</span> *) getAllPoems &#123;	</span><br><span class="line">	<span class="built_in">NSMutableArray</span> *result = [[<span class="built_in">NSMutableArray</span> alloc] init];</span><br><span class="line"><span class="comment">//	FMResultSet *rs = [_db executeQuery:@&quot;SELECT * FROM POEMTABLE WHERE ID=? AND WHETHERFAVORITE=?&quot;, [NSNumber numberWithInt:poem.poemId], [NSNumber numberWithBool:poem.whetherFavorite]];</span></span><br><span class="line">	FMResultSet *rs = [_db executeQuery:<span class="string">@&quot;SELECT * FROM POEMTABLE&quot;</span>];</span><br><span class="line">	<span class="keyword">while</span>([rs next]) &#123;</span><br><span class="line">		BLPoem *poem = [[BLPoem alloc] init];</span><br><span class="line">		poem.poemId = [rs intForColumn:<span class="string">@&quot;ID&quot;</span>];</span><br><span class="line">		poem.poemName = [rs	stringForColumn:<span class="string">@&quot;POEMNAME&quot;</span>];</span><br><span class="line">		poem.poetName = [rs stringForColumn:<span class="string">@&quot;POETNAME&quot;</span>];</span><br><span class="line">		poem.poemContent = [rs stringForColumn:<span class="string">@&quot;POEMCONTENT&quot;</span>];</span><br><span class="line">		poem.whetherFavorite = [rs boolForColumn:<span class="string">@&quot;WHETHERFAVORITE&quot;</span>];</span><br><span class="line">		[result addObject:poem];</span><br><span class="line">	&#125;</span><br><span class="line">	[rs close];</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSMutableArray</span> *) getFavoritesPoems &#123;</span><br><span class="line">	<span class="built_in">NSMutableArray</span> *result = [[<span class="built_in">NSMutableArray</span> alloc] init];	</span><br><span class="line">	FMResultSet *rs = [_db executeQuery:<span class="string">@&quot;SELECT * FROM POEMTABLE WHERE WHETHERFAVORITE=?&quot;</span>, [<span class="built_in">NSNumber</span> numberWithBool:<span class="literal">YES</span>]];</span><br><span class="line">	<span class="keyword">while</span>([rs next]) &#123;</span><br><span class="line">		BLPoem *poem = [[BLPoem alloc] init];</span><br><span class="line">		poem.poemId = [rs intForColumn:<span class="string">@&quot;ID&quot;</span>];</span><br><span class="line">		poem.poemName = [rs	stringForColumn:<span class="string">@&quot;POEMNAME&quot;</span>];</span><br><span class="line">		poem.poetName = [rs stringForColumn:<span class="string">@&quot;POETNAME&quot;</span>];</span><br><span class="line">		poem.poemContent = [rs stringForColumn:<span class="string">@&quot;POEMCONTENT&quot;</span>];</span><br><span class="line">		poem.whetherFavorite = [rs boolForColumn:<span class="string">@&quot;WHETHERFAVORITE&quot;</span>];</span><br><span class="line">		[result addObject:poem];</span><br><span class="line">	&#125;</span><br><span class="line">	[rs close];</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="type">BOOL</span>) setFavorite:(<span class="type">BOOL</span>)favorite favoriteId:(<span class="built_in">NSInteger</span>)poemId &#123;</span><br><span class="line">	<span class="keyword">if</span> (_db == <span class="literal">nil</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	[_db beginTransaction];</span><br><span class="line">	<span class="type">BOOL</span> result = [_db executeUpdate:<span class="string">@&quot;UPDATE POEMTABLE SET WHETHERFAVORITE=? WHERE ID=?&quot;</span>, [<span class="built_in">NSNumber</span> numberWithBool:favorite], [<span class="built_in">NSNumber</span> numberWithInteger:poemId]];</span><br><span class="line">	[_db commit];</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="type">BOOL</span>) deletePoemWithPoemId:(<span class="built_in">NSInteger</span>)poemId &#123;</span><br><span class="line">	[_db beginTransaction];</span><br><span class="line">	<span class="type">BOOL</span> success = [_db executeUpdate:<span class="string">@&quot;DELETE FROM POEMTABLE WHERE ID=?&quot;</span>, [<span class="built_in">NSNumber</span> numberWithInteger:poemId]];</span><br><span class="line">	[_db commit];</span><br><span class="line">	<span class="keyword">if</span>(!success || [_db hadError]) &#123;</span><br><span class="line">		[_db rollback];</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="type">void</span>) dealloc &#123;</span><br><span class="line">	[_db	close];</span><br><span class="line">	_db		= <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<h3 id="延伸阅读："><a href="#延伸阅读：" class="headerlink" title="延伸阅读："></a>延伸阅读：</h3><ul>
<li><a target="_blank" rel="noopener" href="http://www.sqlite.org/">SQLite</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/ccgus/fmdb">FMDB</a></li>
<li><a target="_blank" rel="noopener" href="https://www.objc.io/issues/4-core-data/SQLite-instead-of-core-data/">On Using SQLite and FMDB Instead of Core Data</a></li>
<li><a target="_blank" rel="noopener" href="https://realm.io/">Realm</a></li>
<li><a target="_blank" rel="noopener" href="http://sqlitebrowser.org/">DB Browser for SQLite</a></li>
</ul>
<h2 id="32-多线程和多媒体"><a href="#32-多线程和多媒体" class="headerlink" title="32. 多线程和多媒体"></a>32. 多线程和多媒体</h2><p>简单介绍了常见多媒体的播放：</p>
<ul>
<li>UIImagePickerViewController</li>
<li>UIActionSheet （👈名字谐音）</li>
<li>AVAudioPlayer</li>
<li>SystenSounID</li>
<li>MPMoviePlayerViewController</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&lt;AVFoundation/AVFoundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="string">&lt;AudioToolbox/AudioToolbox.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="string">&lt;MediaPlayer/MediaPlayer.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BLOneViewController</span> ()&lt;<span class="title">UIAlertViewDelegate</span>, <span class="title">UIActionSheetDelegate</span>, <span class="title">UIImagePickerControllerDelegate</span>, <span class="title">UINavigationControllerDelegate</span>&gt; </span>&#123;</span><br><span class="line">    <span class="built_in">AVAudioPlayer</span>           *audioPlayer;</span><br><span class="line">    SystemSoundID           systemSoundId;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> mark - Play Music button action</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)palyMusic:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!audioPlayer) &#123;</span><br><span class="line">        <span class="built_in">NSString</span> *mp3Path = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@&quot;yishengsuoai&quot;</span> ofType:<span class="string">@&quot;mp3&quot;</span>];</span><br><span class="line">        <span class="built_in">NSURL</span> *mp3Url = [[<span class="built_in">NSURL</span> alloc] initFileURLWithPath:mp3Path];</span><br><span class="line">        audioPlayer = [[<span class="built_in">AVAudioPlayer</span> alloc] initWithContentsOfURL:mp3Url error:<span class="literal">NULL</span>];</span><br><span class="line">        audioPlayer.numberOfLoops = <span class="number">-1</span>;</span><br><span class="line">        [audioPlayer prepareToPlay];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ([audioPlayer isPlaying]) &#123;</span><br><span class="line">        [audioPlayer stop];</span><br><span class="line">        sender.titleLabel.text = <span class="string">@&quot;Play Music&quot;</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        [audioPlayer play];</span><br><span class="line">        sender.titleLabel.text = <span class="string">@&quot;Pasue Music&quot;</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="33-硬件访问、CALayer-amp-Core-Graphics"><a href="#33-硬件访问、CALayer-amp-Core-Graphics" class="headerlink" title="33. 硬件访问、CALayer &amp; Core Graphics"></a>33. 硬件访问、CALayer &amp; Core Graphics</h2><h3 id="33-1-gravity-and-user-acceleration"><a href="#33-1-gravity-and-user-acceleration" class="headerlink" title="33.1. gravity and user acceleration"></a>33.1. gravity and user acceleration</h3><p>Useage: shaking device to feedback or 360° image</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4 - Start update divice motion and print them</span></span><br><span class="line">   <span class="comment">// The accelerometer measures the sum of two acceleration vectors: gravity and user acceleration.</span></span><br><span class="line">   <span class="built_in">NSOperationQueue</span> *diviceMotionQueue = [[<span class="built_in">NSOperationQueue</span> alloc] init];</span><br><span class="line">   [<span class="keyword">self</span>.motionManager startDeviceMotionUpdatesToQueue:diviceMotionQueue</span><br><span class="line">                                           withHandler:^(<span class="built_in">CMDeviceMotion</span> *motion, <span class="built_in">NSError</span> *error) &#123;</span><br><span class="line">                                               </span><br><span class="line">                                               <span class="built_in">NSLog</span>(<span class="string">@&quot;\n \n--------------------------------------------------------------------------&gt;\n \n 1 - attitude: %@ \n 2 - rotation rate x: %f, y: %f, z: %f,\n  \n 3 - gravity x: %f, y: %f, z: %f \n \n 4 - user acceleration x: %f, y: %f, z: %f \n \n 5 - magnetic field accuracy: %d, x: %f, y: %f, z: %f \n \n &lt;--------------------------------------------------------------------------\n \n&quot;</span> ,</span><br><span class="line">                                                     motion.attitude,</span><br><span class="line">                                                     motion.rotationRate.x, motion.rotationRate.y, motion.rotationRate.z,</span><br><span class="line">                                                     motion.gravity.x, motion.gravity.y, motion.gravity.z,</span><br><span class="line">                                                     motion.userAcceleration.x, motion.userAcceleration.y, motion.userAcceleration.z,</span><br><span class="line">                                                     motion.magneticField.accuracy, motion.magneticField.field.x, motion.magneticField.field.y, motion.magneticField.field.z);</span><br><span class="line">                                           &#125;];</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Search the definiton of each new word, really 😄😄😄. </p>
<p>Do you believe that, At least I don’t think so.    </p>
</blockquote>
<p>Output:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------------------------------------------------&gt;</span><br><span class="line"> </span><br><span class="line"> 1 - attitude: CMAttitude Pitch: 0.751292, Roll: 0.555726, Yaw: 22.198534</span><br><span class="line"> </span><br><span class="line"> 2 - rotation rate x: 0.001511, y: -0.000795, z: 0.002454,</span><br><span class="line">  </span><br><span class="line"> 3 - gravity x: 0.009698, y: -0.013112, z: -0.999867 </span><br><span class="line"> </span><br><span class="line"> 4 - user acceleration x: -0.002603, y: 0.000783, z: -0.014095 </span><br><span class="line"> </span><br><span class="line"> 5 - magnetic field accuracy: -1, x: 0.000000, y: 0.000000, z: 0.000000 </span><br><span class="line"> </span><br><span class="line"> &lt;--------------------------------------------------------------------------</span><br></pre></td></tr></table></figure>
<h3 id="33-2-CALayer"><a href="#33-2-CALayer" class="headerlink" title="33.2. CALayer"></a>33.2. CALayer</h3><p>Modifying the Layer’s Appearance Properties.<br>Lots of properties really similar to Sketch.</p>
<h3 id="33-3-Core-Graphics"><a href="#33-3-Core-Graphics" class="headerlink" title="33.3. Core Graphics"></a>33.3. Core Graphics</h3><p>CGContextRef: An opaque type that represents a Quartz 2D drawing environment.</p>
<p>Path on CGContextRef vs Vector on Artboard in Sketch, by learn Sketch really make sense of those abstract concepts.</p>
<h2 id="34-自定义手势、Block-amp-GCD"><a href="#34-自定义手势、Block-amp-GCD" class="headerlink" title="34. 自定义手势、Block &amp; GCD"></a>34. 自定义手势、Block &amp; GCD</h2><h3 id="34-1-手势"><a href="#34-1-手势" class="headerlink" title="34.1. 手势"></a>34.1. 手势</h3><p>尽量设计使用常用的手势</p>
<blockquote>
<p>设计一个小 Demo，实现：Shake Your iPhone To Send Feedback Email To Me😄</p>
</blockquote>
<h3 id="34-2-Block"><a href="#34-2-Block" class="headerlink" title="34.2. Block"></a>34.2. Block</h3><p>比较简洁的函数，就在当前就可以调用。</p>
<h3 id="34-3-GCD"><a href="#34-3-GCD" class="headerlink" title="34.3. GCD"></a>34.3. GCD</h3><p>Group queue：并行执行多任务比较牛。</p>
<h2 id="35-APNS、Core-Date、URL-Scheme、单元测试、APP发布流"><a href="#35-APNS、Core-Date、URL-Scheme、单元测试、APP发布流" class="headerlink" title="35. APNS、Core Date、URL Scheme、单元测试、APP发布流"></a>35. APNS、Core Date、URL Scheme、单元测试、APP发布流</h2><h3 id="35-1-APNS"><a href="#35-1-APNS" class="headerlink" title="35.1. APNS"></a>35.1. APNS</h3><p><img src="http://i.imgur.com/2iItYMd.jpg" alt="Remote Notification"></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 - Register Remote Notification</span></span><br><span class="line"><span class="comment">// 2 - Register deviceToken</span></span><br><span class="line"><span class="comment">// 3 - Receive Remote Notification</span></span><br><span class="line"><span class="comment">// 4 - Update Icon Badge Number</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>稍后添加到 Classmates</p>
</blockquote>
<h3 id="35-2-Core-Data"><a href="#35-2-Core-Data" class="headerlink" title="35.2. Core Data"></a>35.2. Core Data</h3><p>核心概念：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 程序员和管理对象模式之间的桥梁，做数据库的增删改查等操作</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSManagedObjectContext</span> *managedObjectContext;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数据库里的不同管理对象类型</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSManagedObjectModel</span> *managedObjectModel;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数据库文件和程序之间的联系桥梁</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSPersistentStoreCoordinator</span> *persistentStoreCoordinator;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>稍后把 Classmate 整个 Core Data 的版本</p>
</blockquote>
<h3 id="35-3-URL-Scheme"><a href="#35-3-URL-Scheme" class="headerlink" title="35.3. URL Scheme"></a>35.3. URL Scheme</h3><p>就是一个通过个地址访问系统软件或第三方软件，如地图和 Launch Center Pro。iOS 9之后估计有更多可能性。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/library/ios/featuredarticles/iPhoneURLScheme_Reference/Introduction/Introduction.html">About Apple URL Schemes</a></li>
</ul>
<h3 id="35-4-单元测试或断点测试"><a href="#35-4-单元测试或断点测试" class="headerlink" title="35.4. 单元测试或断点测试"></a>35.4. 单元测试或断点测试</h3><h3 id="35-5-App-发布流程"><a href="#35-5-App-发布流程" class="headerlink" title="35.5. App 发布流程"></a>35.5. App 发布流程</h3>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/08/28/GeekBand-iOS-Design-Patterns-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/08/28/GeekBand-iOS-Design-Patterns-3/" class="post-title-link" itemprop="url">极客班 iOS 设计模式（三）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-08-28 22:17:21" itemprop="dateCreated datePublished" datetime="2015-08-28T22:17:21+08:00">2015-08-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-01-13 11:01:04" itemprop="dateModified" datetime="2025-01-13T11:01:04+08:00">2025-01-13</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>设计模式课程给我的感受是：理清各种平时固定用的 API 的背后的原理或思路，尤其是写代码时候反复去审视开发框架和思路都有一定的帮助。</p>
<p>课件下载：<a target="_blank" rel="noopener" href="https://github.com/gewill/GeekBand-iOS-Demo/tree/master/Design%20Patterns">https://github.com/gewill/GeekBand-iOS-Demo/tree/master/Design%20Patterns</a></p>
<h2 id="11-层次结构"><a href="#11-层次结构" class="headerlink" title="11. 层次结构"></a>11. 层次结构</h2><h3 id="动机："><a href="#动机：" class="headerlink" title="动机："></a>动机：</h3><ul>
<li>对象之间关系</li>
<li>允许一组相互协作的对象当成单⼀对象处理</li>
<li>无需⼦类化,实现⾃定义</li>
<li>降低 parents class 复杂度</li>
<li>使用 tree 结构,⽅便数据的存储,操作和搜索</li>
</ul>
<p><img src="http://i.imgur.com/9bGOm2k.png" alt="Layers associated with a window"></p>
<p><img src="http://i.imgur.com/R7XAflX.jpg" alt="View Hierarchy in Xcode"></p>
<blockquote>
<p>其实还有更强大的工具：<a target="_blank" rel="noopener" href="http://revealapp.com/">Reveal</a>，附<a target="_blank" rel="noopener" href="http://gewill.org/2015/08/03/Reveal/">使用方法</a>。</p>
</blockquote>
<p>节选自<code>UIView.h</code>：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UIView</span>(<span class="title">UIViewHierarchy</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>) <span class="built_in">UIView</span>       *superview;</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>,<span class="keyword">copy</span>) <span class="built_in">NSArray</span> *subviews;</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>) <span class="built_in">UIWindow</span>     *window;</span><br><span class="line"></span><br><span class="line">- (<span class="type">void</span>)removeFromSuperview;</span><br><span class="line">- (<span class="type">void</span>)insertSubview:(<span class="built_in">UIView</span> *)view atIndex:(<span class="built_in">NSInteger</span>)index;</span><br><span class="line">- (<span class="type">void</span>)exchangeSubviewAtIndex:(<span class="built_in">NSInteger</span>)index1 withSubviewAtIndex:(<span class="built_in">NSInteger</span>)index2;</span><br><span class="line"></span><br><span class="line">- (<span class="type">void</span>)addSubview:(<span class="built_in">UIView</span> *)view;</span><br><span class="line">- (<span class="type">void</span>)insertSubview:(<span class="built_in">UIView</span> *)view belowSubview:(<span class="built_in">UIView</span> *)siblingSubview;</span><br><span class="line">- (<span class="type">void</span>)insertSubview:(<span class="built_in">UIView</span> *)view aboveSubview:(<span class="built_in">UIView</span> *)siblingSubview;</span><br><span class="line"></span><br><span class="line">- (<span class="type">void</span>)bringSubviewToFront:(<span class="built_in">UIView</span> *)view;</span><br><span class="line">- (<span class="type">void</span>)sendSubviewToBack:(<span class="built_in">UIView</span> *)view;</span><br><span class="line"></span><br><span class="line">- (<span class="type">void</span>)didAddSubview:(<span class="built_in">UIView</span> *)subview;</span><br><span class="line">- (<span class="type">void</span>)willRemoveSubview:(<span class="built_in">UIView</span> *)subview;</span><br><span class="line"></span><br><span class="line">- (<span class="type">void</span>)willMoveToSuperview:(<span class="built_in">UIView</span> *)newSuperview;</span><br><span class="line">- (<span class="type">void</span>)didMoveToSuperview;</span><br><span class="line">- (<span class="type">void</span>)willMoveToWindow:(<span class="built_in">UIWindow</span> *)newWindow;</span><br><span class="line">- (<span class="type">void</span>)didMoveToWindow;</span><br><span class="line"></span><br><span class="line">- (<span class="type">BOOL</span>)isDescendantOfView:(<span class="built_in">UIView</span> *)view;  <span class="comment">// returns YES for self.</span></span><br><span class="line">- (<span class="built_in">UIView</span> *)viewWithTag:(<span class="built_in">NSInteger</span>)tag;     <span class="comment">// recursive search. includes self</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Allows you to perform layout before the drawing cycle happens. -layoutIfNeeded forces layout early</span></span><br><span class="line">- (<span class="type">void</span>)setNeedsLayout;</span><br><span class="line">- (<span class="type">void</span>)layoutIfNeeded;</span><br></pre></td></tr></table></figure>

<h3 id="iOS-rendering-tree"><a href="#iOS-rendering-tree" class="headerlink" title="iOS rendering tree:"></a>iOS rendering tree:</h3><ul>
<li>UIView 负责界⾯显示和事件处理</li>
<li>CALayer 负责屏幕渲染(Layer Tree)</li>
<li>View&#x2F;Layer 的变化需要通过渲染器实时渲染到屏幕上</li>
<li>layer.presentationLayer</li>
</ul>
<p><img src="http://i.imgur.com/W3RoHiP.png" alt="The layer trees for a window"></p>
<h3 id="延伸阅读："><a href="#延伸阅读：" class="headerlink" title="延伸阅读："></a>延伸阅读：</h3><ul>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/library/ios/documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/Introduction/Introduction.html">View Programming Guide for iOS</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/library/ios/recipes/xcode_help-debugger/using_view_debugger/using_view_debugger.html">Debug View Hierarchy</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CoreAnimation_guide/CoreAnimationBasics/CoreAnimationBasics.html">Core Animation Basics</a></li>
</ul>
<h2 id="12-响应链（Responder-Chain）"><a href="#12-响应链（Responder-Chain）" class="headerlink" title="12. 响应链（Responder Chain）"></a>12. 响应链（Responder Chain）</h2><p><img src="https://developer.apple.com/library/prerelease/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/Art/iOS_responder_chain_2x.png" alt="The responder chain on iOS"></p>
<p>节选自 <code>UIResponder.h</code>：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NS_CLASS_AVAILABLE_IOS</span>(<span class="number">2</span>_0) <span class="class"><span class="keyword">@interface</span> <span class="title">UIResponder</span> : <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">  <span class="keyword">@private</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIResponder</span>*)nextResponder;</span><br><span class="line"></span><br><span class="line">- (<span class="type">BOOL</span>)canBecomeFirstResponder;    <span class="comment">// default is NO</span></span><br><span class="line">- (<span class="type">BOOL</span>)becomeFirstResponder;</span><br><span class="line"></span><br><span class="line">- (<span class="type">BOOL</span>)canResignFirstResponder;    <span class="comment">// default is YES</span></span><br><span class="line">- (<span class="type">BOOL</span>)resignFirstResponder;</span><br><span class="line"></span><br><span class="line">- (<span class="type">BOOL</span>)isFirstResponder;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generally, all responders which do custom touch handling should override all four of these methods.</span></span><br><span class="line"><span class="comment">// Your responder will receive either touchesEnded:withEvent: or touchesCancelled:withEvent: for each</span></span><br><span class="line"><span class="comment">// touch it is handling (those touches it received in touchesBegan:withEvent:).</span></span><br><span class="line"><span class="comment">// *** You must handle cancelled touches to ensure correct behavior in your application.  Failure to</span></span><br><span class="line"><span class="comment">// do so is very likely to lead to incorrect behavior or crashes.</span></span><br><span class="line">- (<span class="type">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="type">void</span>)touchesMoved:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="type">void</span>)touchesEnded:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="type">void</span>)touchesCancelled:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event;</span><br><span class="line"></span><br><span class="line">- (<span class="type">void</span>)motionBegan:(<span class="built_in">UIEventSubtype</span>)motion withEvent:(<span class="built_in">UIEvent</span> *)event <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_0);</span><br><span class="line">- (<span class="type">void</span>)motionEnded:(<span class="built_in">UIEventSubtype</span>)motion withEvent:(<span class="built_in">UIEvent</span> *)event <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_0);</span><br><span class="line">- (<span class="type">void</span>)motionCancelled:(<span class="built_in">UIEventSubtype</span>)motion withEvent:(<span class="built_in">UIEvent</span> *)event <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_0);</span><br><span class="line"></span><br><span class="line">- (<span class="type">void</span>)remoteControlReceivedWithEvent:(<span class="built_in">UIEvent</span> *)event <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">4</span>_0);</span><br><span class="line"></span><br><span class="line">- (<span class="type">BOOL</span>)canPerformAction:(SEL)action withSender:(<span class="type">id</span>)sender <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_0);</span><br><span class="line"><span class="comment">// Allows an action to be forwarded to another target. By default checks -canPerformAction:withSender: to either return self, or go up the responder chain.</span></span><br><span class="line">- (<span class="type">id</span>)targetForAction:(SEL)action withSender:(<span class="type">id</span>)sender <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">7</span>_0);</span><br></pre></td></tr></table></figure>

<p><img src="http://i.imgur.com/iHPA7mx.png" alt="UIKit Inheritance"></p>
<h3 id="延伸阅读：-1"><a href="#延伸阅读：-1" class="headerlink" title="延伸阅读："></a>延伸阅读：</h3><ul>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/library/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/Introduction/Introduction.html">Event Handling Guide for iOS</a></li>
</ul>
<h2 id="13-Prototype"><a href="#13-Prototype" class="headerlink" title="13. Prototype"></a>13. Prototype</h2><p>如 UITableView 的 Prototype Cells：</p>
<ul>
<li>原型对象的基本特征是可以被复制 NSCopy 和 NSCoding 协议</li>
<li>可以利用界面⼯具和支持复制的类确保互操作性</li>
<li>原型对象使用深复制</li>
<li>利用 NSKeyedArchiver 和 NSKeyedUnarchiver 实现深复制</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>MVC,target-action</li>
<li>￼两步创建，模版模式 </li>
<li>委托模式，观察者模式，消息通知，KVC&#x2F;KVO</li>
<li>归档和解档(Serialization)，复制模式 </li>
<li>层次结构，响应链</li>
<li>prototype</li>
</ul>
<blockquote>
<p>完</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/08/27/MVVM-Notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/08/27/MVVM-Notes/" class="post-title-link" itemprop="url">MVVM - 笔记</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-08-27 23:46:43" itemprop="dateCreated datePublished" datetime="2015-08-27T23:46:43+08:00">2015-08-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-01-13 11:01:04" itemprop="dateModified" datetime="2025-01-13T11:01:04+08:00">2025-01-13</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>一句话就是剥离或轻量化 Controller 中关于 View 和 Model 的部分。</p>
<h2 id="MVVM-介绍"><a href="#MVVM-介绍" class="headerlink" title="MVVM 介绍"></a><a target="_blank" rel="noopener" href="http://objccn.io/issue-13-1/">MVVM 介绍</a></h2><p>MVC 有人称之为 Massive View Controller。</p>
<p>MVC 并没有做太多事情来解决 iOS 应用中日益增长的重量级视图控制器的问题。在典型的 MVC 应用里，许多逻辑被放在 View Controller 里。它们中的一些确实属于 View Controller，但更多的是所谓的“表示逻辑（<strong>presentation logic</strong>）”，以 MVVM 属术语来说，就是那些将 Model 数据转换为 View 可以呈现的东西的事情，例如将一个 NSDate 转换为一个格式化过的 NSString。根据 Model 属性设置 UILabel、UIButton text。 </p>
<p><img src="/../assets/MVVM-Notes/mvvm.png" alt="Model-View-ViewModel"></p>
<p>我们的图解里缺少某些东西，那些使我们可以把所有表示逻辑放进去的东西。我们打算将其称为 “View Model” —— 它位于 View&#x2F;Controller 与 Model 之间：</p>
<p>Model-View-ViewModel 可以：</p>
<ul>
<li>MVVM 可以兼容你当下使用的 MVC 架构。</li>
<li>MVVM 增加你的应用的可测试性。</li>
<li>MVVM 配合一个绑定机制效果最好。</li>
</ul>
<p><strong>并没有对我们的 MVC 架构做太多改变。还是同样的代码，只不过移动了位置。它与 MVC 兼容，带来更轻量的 View Controllers。</strong></p>
<p>Model 是不可变的，所以我们可以只在初始化的时候指定我们 View Model 的属性。对于可变 Model，我们还需要使用一些绑定机制，这样 View Model 就能在背后的 Model 改变时更新自身的属性。此外，一旦 View Model 上的 Model 发生改变，那 View 的属性也需要更新。Model 的改变应该级联向下通过 View Model 进入 View。</p>
<h2 id="更轻量的-View-Controllers"><a href="#更轻量的-View-Controllers" class="headerlink" title="更轻量的 View Controllers"></a><a target="_blank" rel="noopener" href="http://objccn.io/issue-1-1/">更轻量的 View Controllers</a></h2><ul>
<li>把 Data Source 和其他 Protocols 分离出来</li>
<li>将 Domain Logic 移到 Model 中</li>
<li>创建 Store 类</li>
<li>把网络请求逻辑移到 Model 层</li>
<li>把 View 代码移到 View 层</li>
</ul>
<p>我们已经看到一些用来创建更小巧的 view controllers 的技术。我们并不是想把这些技术应用到每一个可能的角落，只是我们有一个目标：写可维护的代码。知道这些模式后，我们就更有可能把那些笨重的 view controllers 变得更整洁。</p>
<h2 id="延伸阅读："><a href="#延伸阅读：" class="headerlink" title="延伸阅读："></a>延伸阅读：</h2><ul>
<li><p><a target="_blank" rel="noopener" href="http://www.codeproject.com/Articles/100175/Model-View-ViewModel-MVVM-Explained">Model-View-ViewModel (MVVM) Explained</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.wikiwand.com/en/Model_View_ViewModel">Model View ViewModel</a></p>
<blockquote>
<p><img src="/../assets/MVVM-Notes/MVVMPattern.png" alt="img"></p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.teehanlax.com/blog/model-view-viewmodel-for-ios/">Model-View-ViewModel for iOS</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.teehanlax.com/blog/krush-ios-architecture/">Krush iOS Architecture</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/BasicViewControllers/BasicViewControllers.html">View Controller Programming Guide for iOS</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://developer.apple.com/library/mac/#documentation/General/Conceptual/DevPedia-CocoaCore/ControllerObject.html">Cocoa Core Competencies: Controller Object</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://subjective-objective-c.blogspot.de/2011/08/writing-high-quality-view-controller.html">Writing high quality view controllers</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://programmers.stackexchange.com/questions/184396/mvcs-model-view-controller-store">Stack Overflow: Model View Controller Store</a></p>
<blockquote>
<p>I will often create a singleton manager class that handles setting up the Core Data stack, and deals with all of the fetching&#x2F;saving that is involved with the stack. As the quote you mentioned says, this makes it very easy to not only call those methods, but to adjust them if needed, as opposed to having saving&#x2F;fetching calls all over the place in different view controllers.</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://speakerdeck.com/trianglecocoa/unburdened-viewcontrollers-by-jay-thrash">Unburdened View Controllers</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://programmers.stackexchange.com/questions/177668/how-to-avoid-big-and-clumsy-uitableviewcontroller-on-ios">Stack Overflow: How to avoid big and clumsy <code>UITableViewControllers</code> on iOS</a></p>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/08/24/CS193P-Fall-2013-11-Table-View-and-iPad/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/08/24/CS193P-Fall-2013-11-Table-View-and-iPad/" class="post-title-link" itemprop="url">CS193P Fall 2013: 11.Table View and iPad</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-08-24 09:35:28" itemprop="dateCreated datePublished" datetime="2015-08-24T09:35:28+08:00">2015-08-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-01-13 11:01:04" itemprop="dateModified" datetime="2025-01-13T11:01:04+08:00">2025-01-13</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>之前直接听英语单词不懂，基础概念也没有，很难真正明白。现在学习了许多中文课程，主要是概念有了，重新看一遍，容易理解的多。</p>
<p>所以最好是想看中文了解相关背景概念，熟悉一下其实的关键词对应的英文，然后再学习英文的课程。</p>
<p>项目驱动，习题驱动学习比较有劲头。</p>
<h2 id="Table-View"><a href="#Table-View" class="headerlink" title="Table View"></a>Table View</h2><ul>
<li>UITableView Segue: <code>NSIndexPath *indexPath = [self.tableView indexPathForCell:sender];</code></li>
<li>UITableView Spinner: UITableViewController has an “activity indicator” built in</li>
<li>What if your Model changes? <code>(void)reloadData;</code></li>
</ul>
<h2 id="Universal-Applications"><a href="#Universal-Applications" class="headerlink" title="Universal Applications"></a>Universal Applications</h2><p>Generally recommned use different storyboards.</p>
<h2 id="UISplitViewController"><a href="#UISplitViewController" class="headerlink" title="UISplitViewController"></a>UISplitViewController</h2><ul>
<li>UISplitViewControllerDelegate: <code>awakeFromNib</code></li>
<li>Hide Master in portrait orientation only (the default)</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/08/22/GeekBand-Test-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Ge Will">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Will's Blog">
      <meta itemprop="description" content="The people who are crazy enough to think they can change the world, are the ones who DO.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Will's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/08/22/GeekBand-Test-2/" class="post-title-link" itemprop="url">GeekBand Test 2</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-08-22 22:00:00" itemprop="dateCreated datePublished" datetime="2015-08-22T22:00:00+08:00">2015-08-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-01-13 11:01:04" itemprop="dateModified" datetime="2025-01-13T11:01:04+08:00">2025-01-13</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="做习题涉及和想到的点"><a href="#做习题涉及和想到的点" class="headerlink" title="做习题涉及和想到的点"></a>做习题涉及和想到的点</h2><blockquote>
<p>我的习题代码 <a target="_blank" rel="noopener" href="https://github.com/gewill/GeekBand-IOS-1501-Homework/tree/new-branch/G2015010176/iOS%20APP%20Development">Github</a></p>
</blockquote>
<ul>
<li>Lazy load image in table view: Apple example<br><a target="_blank" rel="noopener" href="https://developer.apple.com/library/ios/samplecode/LazyTableImages/Introduction/Intro.html">LazyTableImagesor</a> or <a target="_blank" rel="noopener" href="https://github.com/rs/SDWebImage">SDWebImage</a></li>
<li>Try NSURLSession </li>
<li>望文生义的能力很重要</li>
<li>拿到一个项目代码，start step into from initial view，了解了整个 app 的运行时的结构或循环，才能理解整个 app 的逻辑框架。</li>
<li>框架&gt;目录&gt;类&gt;方法&gt;属性&#x2F;实例变量，这样子下来整个一个 App 就跑起来了，入口就是 main.m，然后各种设置属性和发消息，基于事件驱动的这一层理解运行时是比较合适的颗粒。</li>
<li>Lazy load iamge use AFNetworking</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[cell.appImage setImageWithURL:[<span class="built_in">NSURL</span> URLWithString:[mediumImage valueForKeyPath:<span class="string">@&quot;label&quot;</span>]] placeholderImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@&quot;placeholder&quot;</span>]];</span><br></pre></td></tr></table></figure>

<h2 id="习题完成情况"><a href="#习题完成情况" class="headerlink" title="习题完成情况"></a>习题完成情况</h2><h3 id="第二题"><a href="#第二题" class="headerlink" title="第二题"></a>第二题</h3><p>完成 1.0:</p>
<ul>
<li>实现 table view 自带刷新</li>
<li>添加 Cellular 开关，并能够检查网络连接方式，并提醒用户</li>
<li>NSURLSession 下载 JSON</li>
</ul>
<blockquote>
<p>2015-08-26</p>
</blockquote>
<p>进行中 1.1: </p>
<ul>
<li>Lazy load iamge use AFNetworking</li>
</ul>
<blockquote>
<p>2015-09-03 11:36:32</p>
</blockquote>
<h3 id="Further-Reading"><a href="#Further-Reading" class="headerlink" title="Further Reading"></a>Further Reading</h3><ul>
<li><p><a target="_blank" rel="noopener" href="http://blog.ibireme.com/2015/05/18/runloop/#apple">深入理解 RunLoop</a></p>
<blockquote>
<p>通过 Runloop 讲解了 NSURLConnection 的工作过程<br>iOS 中，关于网络请求的接口自下至上有如下几层:</p>
</blockquote>
</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CFSocket</span></span><br><span class="line"><span class="built_in">CFNetwork</span>       -&gt;ASIHttpRequest</span><br><span class="line"><span class="built_in">NSURLConnection</span> -&gt;AFNetworking</span><br><span class="line"><span class="built_in">NSURLSession</span>    -&gt;AFNetworking2, Alamofire</span><br></pre></td></tr></table></figure>
<ul>
<li><p>CFSocket 是最底层的接口，只负责 socket 通信。</p>
</li>
<li><p>CFNetwork 是基于 CFSocket 等接口的上层封装，ASIHttpRequest 工作于这一层。</p>
</li>
<li><p>NSURLConnection 是基于 CFNetwork 的更高层的封装，提供面向对象的接口，AFNetworking 工作于这一层。</p>
</li>
<li><p>NSURLSession 是 iOS7 中新增的接口，表面上是和 NSURLConnection 并列的，但底层仍然用到了 NSURLConnection 的部分功能 (比如 com.apple.NSURLConnectionLoader 线程)，AFNetworking2 和 Alamofire 工作于这一层。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://cocoadocs.org/docsets/AFNetworking/2.6.0/index.html">Network Reachability Manager</a></p>
<blockquote>
<p>AFNetworkReachabilityManager monitors the reachability of domains, and addresses for both WWAN and WiFi network interfaces.</p>
</blockquote>
<blockquote>
<p>Do not use Reachability to determine if the original request should be sent.</p>
</blockquote>
</li>
</ul>
<p>You should try to send it.<br>You can use Reachability to determine when a request should be automatically retried.<br>Although it may still fail, a Reachability notification that the connectivity is available is a good time to retry something.<br>Network reachability is a useful tool for determining why a request might have failed.<br>After a network request has failed, telling the user they’re offline is better than giving them a more technical but accurate error, such as “request timed out.”</p>
<ul>
<li><p>See also <a target="_blank" rel="noopener" href="https://developer.apple.com/videos/wwdc/2012/#706%22">WWDC 2012 session 706, “Networking Best Practices</a>.</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/rs/SDWebImage">SDWebImage</a></p>
<blockquote>
<p>AFNetworking takes advantage of Foundation URL Loading System caching using NSURLCache, as well as a configurable in-memory cache for UIImageView and UIButton, which uses NSCache by default. Caching behavior can be further specified in the caching policy of a corresponding NSURLRequest. Other SDWebImage features, like background decompression of image data is also provided by AFNetworking.</p>
</blockquote>
<blockquote>
<p>If you’re already using AFNetworking and just want an easy async image loading category, the built-in UIKit extensions will probably fit your needs.
  </p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/AFNetworking/AFNetworking">AFNetworking</a> example</p>
<blockquote>
<p>iOS example 非常经典，包含了使用方法和一个 UITableView实用框架。</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.raywenderlich.com/59255/afnetworking-2-0-tutorial">AFNetworking 2.0 Tutorial</a></p>
</li>
</ul>
<h2 id="测试题原文"><a href="#测试题原文" class="headerlink" title="测试题原文"></a>测试题原文</h2><h3 id="1-做一个类似微信的聊天的-tableview-tablewviewcell-自定义-。只需要-显示文字内容和用户头像-不需要做输入部分-文字内容自己模拟"><a href="#1-做一个类似微信的聊天的-tableview-tablewviewcell-自定义-。只需要-显示文字内容和用户头像-不需要做输入部分-文字内容自己模拟" class="headerlink" title="1. 做一个类似微信的聊天的 tableview(tablewviewcell 自定义) 。只需要 显示文字内容和用户头像(不需要做输入部分,文字内容自己模拟)"></a>1. 做一个类似微信的聊天的 tableview(tablewviewcell 自定义) 。只需要 显示文字内容和用户头像(不需要做输入部分,文字内容自己模拟)</h3><p>1 必须实现文字内容背景<br>2 背景的长度和高度要合适<br>3 发生者和接受者左右布局区分  </p>
<h3 id="2-使用-http-api-请求解析-json-or-xml-数据-并且使用-tableview-展示出来-http-ax-itunes-apple-com-WebObjects-MZStoreServices-woa-ws-RSS-toppaidapplications-limit-10-json-or-xml"><a href="#2-使用-http-api-请求解析-json-or-xml-数据-并且使用-tableview-展示出来-http-ax-itunes-apple-com-WebObjects-MZStoreServices-woa-ws-RSS-toppaidapplications-limit-10-json-or-xml" class="headerlink" title="2. 使用 http api 请求解析 json or xml 数据,并且使用 tableview 展示出来 http://ax.itunes.apple.com/WebObjects/MZStoreServices.woa/ws/RSS/toppaidapplications/limit=10/json or xml"></a>2. 使用 http api 请求解析 json or xml 数据,并且使用 tableview 展示出来 <a target="_blank" rel="noopener" href="http://ax.itunes.apple.com/WebObjects/MZStoreServices.woa/ws/RSS/toppaidapplications/limit=10/json">http://ax.itunes.apple.com/WebObjects/MZStoreServices.woa/ws/RSS/toppaidapplications/limit=10/json</a> or xml</h3><p><strong>提示</strong>:  </p>
<ol>
<li>可以使用第三方库,也可以使用 SDK 基础库  </li>
<li>显示网络下载数据时间  </li>
<li>比较 xml or json 解析效率  </li>
<li>tableviewcell自定义</li>
</ol>
<p>注:</p>
<ul>
<li>希望大家在一周内上传答案到极客班 github 个人的作业文件夹(以学生编 号命名)</li>
<li>IOS 专业 Github 目录: <a target="_blank" rel="noopener" href="https://github.com/GeekBand/GeekBand-IOS-1501-Homework">https://github.com/GeekBand/GeekBand-IOS-1501-Homework</a></li>
<li>老师会在直播环节点评此题</li>
<li>作业的最终批改和成绩公布会在结业时进行。</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/11/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/13/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Ge Will</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  





</body>
</html>
